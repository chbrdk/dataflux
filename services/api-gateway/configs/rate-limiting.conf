# Rate limiting configuration
# Additional rate limiting rules for specific endpoints

# Stricter rate limiting for file uploads
limit_req_zone $binary_remote_addr zone=strict_upload:10m rate=1r/s;

# Rate limiting for API endpoints
limit_req_zone $binary_remote_addr zone=api_strict:10m rate=5r/s;

# Rate limiting for search endpoints
limit_req_zone $binary_remote_addr zone=search_strict:10m rate=10r/s;

# IP whitelist for admin endpoints
geo $admin_allowed {
    default 0;
    127.0.0.1 1;
    10.0.0.0/8 1;
    172.16.0.0/12 1;
    192.168.0.0/16 1;
}

# Map for admin access
map $admin_allowed $admin_access {
    0 "deny";
    1 "allow";
}
